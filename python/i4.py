import os

import requests
from bs4 import BeautifulSoup
import mysql.connector

# 创建数据库连接
conn = mysql.connector.connect(
    host="192.168.5.151",
    user="esports",
    password="123456",
    database="esports"
)

# 创建游标对象
cursor = conn.cursor()

# 创建表
create_table_query = """
CREATE TABLE IF NOT EXISTS matches (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(255),
    state VARCHAR(255)
)
"""
cursor.execute(create_table_query)


html='''
<div class="left" data-v-0c42846a=""><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-img" data-v-0c42846a="" data-v-5784ed69-s="" style="background-image: linear-gradient(rgba(28, 128, 238, 0.5) 0%, rgb(28, 128, 238) 100%), url(&quot;//i1.hdslb.com/bfs/legacy/f6de8e46d95a6b2ed893208eccdf4ead47695a94.png@88h.avif&quot;);"><img src="//i1.hdslb.com/bfs/legacy/b91977a6478a221425d0f1a47b374f35dce8a9f5.png@130w_45h.avif" loading="lazy" class="logo" data-v-0c42846a="" data-v-5784ed69-s=""></div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(0px, -100.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><span class="season-content-item-state playing" data-v-3c314e35=""> 进行中 </span><!--v-if--><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024LPL夏季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024MSI</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024LPL春季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023LPL全明星</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-img" data-v-0c42846a="" data-v-5784ed69-s="" style="background-image: linear-gradient(rgba(177, 151, 84, 0.5) 0%, rgb(177, 151, 84) 100%), url(&quot;//i1.hdslb.com/bfs/legacy/d5e472ea541aba17f7e89cf76552f0f1fa2e3102.jpg@88h.avif&quot;);"><img src="//i1.hdslb.com/bfs/legacy/5082f022664d2187a8876bc5b6141350969c8953.png@130w_45h.avif" loading="lazy" class="logo" data-v-0c42846a="" data-v-5784ed69-s=""></div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(206px, -100.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><span class="season-content-item-state playing" data-v-3c314e35=""> 进行中 </span><!--v-if--><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024KPL夏季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024KPL春季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023王者荣耀世界冠军杯</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023王者荣耀挑战者杯</span></div></div><!----></div></div><div class="game-list" data-v-0c42846a="" style="--num: 4; --width: 120px;"><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag" data-v-0c42846a="" data-v-5784ed69-s="">无畏契约</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(412px, -100.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><span class="season-content-item-state playing" data-v-3c314e35=""> 进行中 </span><!--v-if--><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">VCT CN联赛 第二赛段</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">上海大师赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">VCT CN联赛第一赛段</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">无畏契约马德里大师赛</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag" data-v-0c42846a="" data-v-5784ed69-s="">DOTA2</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(544px, -100.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><span class="season-content-item-state playing" data-v-3c314e35=""> 进行中 </span><!--v-if--><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">EWC DOTA2项目</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">梦幻联赛S23</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">ESL ONE伯明翰</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">梦幻联赛S22</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag" data-v-0c42846a="" data-v-5784ed69-s="">第五人格</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(676px, -100.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><span class="season-content-item-state playing" data-v-3c314e35=""> 进行中 </span><!--v-if--><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024IVL夏季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">深渊的呼唤Ⅶ</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023IVL秋季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023IVS亚洲洲际赛</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag game-list-tag-sec" data-v-0c42846a="" data-v-5784ed69-s="">CSGO</div></div><div class="popper fade-enter-to" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(808px, -100.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024BLAST春季决赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024IEM达拉斯</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">EPL S19</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2024IEM成都</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag game-list-tag-sec" data-v-0c42846a="" data-v-5784ed69-s="">绝地求生</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(412px, -50.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PGC全球总决赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PNC全明星</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PGS2</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PGS2资格赛</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag game-list-tag-sec" data-v-0c42846a="" data-v-5784ed69-s="">和平精英</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(544px, -50.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PMGC全球总决赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PEL夏季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023PEL春季赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2022PMGC全球总决赛</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag game-list-tag-sec" data-v-0c42846a="" data-v-5784ed69-s="">综合赛事</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(676px, -49.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2023机甲大师超级对抗赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2022机甲大师超级对抗赛</span></div></div><!----></div></div><div class="inline-block" data-v-5784ed69="" data-v-0c42846a="" style="border: 12px solid transparent; margin: -12px; --c81fc0a4: 9999;"><div data-v-5784ed69=""><div class="game-list-tag game-list-tag-sec" data-v-0c42846a="" data-v-5784ed69-s="">守望先锋</div></div><div class="popper" data-v-5784ed69="" style="position: absolute; inset: auto auto 0px 0px; margin: 0px; transform: translate3d(808px, -49.4px, 0px); display: none;" data-popper-placement="top-start"><div class="season-content" data-v-3c314e35="" data-v-0c42846a="" data-v-5784ed69-s=""><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2022守望先锋联赛</span></div><div class="season-content-item" data-v-3c314e35=""><!--v-if--><span class="season-content-item-state end" data-v-3c314e35=""> 已结束 </span><!--v-if--><span class="season-content-item-title line-ellipsis" data-v-3c314e35="">2021 守望先锋联赛</span></div></div><!----></div></div><!--v-if--></div></div>

'''

soup = BeautifulSoup(html, 'html.parser')

# 提取赛事名称和状态
season_items = soup.find_all('div', class_='season-content-item')
data = []
for item in season_items:
    state = item.find('span', class_='season-content-item-state').text.strip()
    title = item.find('span', class_='season-content-item-title').text.strip()
    data.append({'state': state, 'title': title})

# 插入数据到数据库
insert_query = "INSERT INTO matches (state, title) VALUES (%s, %s)"
for item in data:
    cursor.execute(insert_query, (item['state'], item['title']))

# 提交更改
conn.commit()

# 关闭游标和连接
cursor.close()
conn.close()